services:
  pingfederate:
    build: .
    container_name: pingfederate
    ports:
      - "9031:9031"  # PingFederate Runtime Engine (HTTPS)
      - "9999:9999"  # PingFederate Admin Console (HTTPS)
    restart: "no"
    environment:
      - PING_IDENTITY_ACCEPT_EULA=YES
      - PING_IDENTITY_PASSWORD="2FederateM0re"
    volumes:
      - pingfederate-data:/opt/out
    networks:
      - pingfederate-network

  pingfederate-mcp:
    build:
      context: ..
      dockerfile: docker/mcp.Dockerfile
    container_name: pingfederate-mcp
    depends_on:
      - pingfederate
    environment:
      - PF_BASE_URL=https://pingfederate:9999/pf-admin-api/v1
      - PF_USERNAME=Administrator
      - PF_PASSWORD=2FederateM0re
      - PF_VERIFY_TLS=false
    networks:
      - pingfederate-network

volumes:
  pingfederate-data:

networks:
  pingfederate-network:
    driver: bridge
